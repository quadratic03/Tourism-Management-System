<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Analytics Dashboard - Tourist Management System</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Custom CSS -->
    <link rel="stylesheet" href="../../css/style.css">
</head>
<body>
    <div class="dashboard-container">
        <!-- Sidebar -->
        <div class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <a href="../dashboard.html" class="sidebar-logo">
                    <div class="d-flex align-items-center">
                        <img src="../../img/logo.png" alt="Logo" class="logo-img" onerror="this.src='https://via.placeholder.com/50x50?text=TMS'">
                        <span class="logo-text">TMS</span>
                    </div>
                </a>
                <a href="#" class="sidebar-collapse d-none d-md-block">
                    <i class="fas fa-bars"></i>
                </a>
            </div>
            <div class="sidebar-menu">
                <a href="../dashboard.html" class="menu-item">
                    <i class="fas fa-tachometer-alt"></i>
                    <span class="menu-item-text">Dashboard</span>
                </a>
                <a href="../tourists/index.html" class="menu-item">
                    <i class="fas fa-users"></i>
                    <span class="menu-item-text">Tourists</span>
                </a>
                <a href="../bookings/index.html" class="menu-item">
                    <i class="fas fa-calendar-check"></i>
                    <span class="menu-item-text">Bookings</span>
                </a>
                <div class="menu-divider"></div>
                <a href="index.html" class="menu-item active">
                    <i class="fas fa-chart-line"></i>
                    <span class="menu-item-text">Analytics</span>
                </a>
                <a href="../guides/index.html" class="menu-item">
                    <i class="fas fa-user-tie"></i>
                    <span class="menu-item-text">Tour Guides</span>
                </a>
                <a href="../payments/index.html" class="menu-item">
                    <i class="fas fa-credit-card"></i>
                    <span class="menu-item-text">Payments</span>
                </a>
                <a href="../weather/index.html" class="menu-item">
                    <i class="fas fa-cloud-sun"></i>
                    <span class="menu-item-text">Weather</span>
                </a>
                <a href="../documents/index.html" class="menu-item">
                    <i class="fas fa-file-alt"></i>
                    <span class="menu-item-text">Documents</span>
                </a>
                <a href="../itinerary/index.html" class="menu-item">
                    <i class="fas fa-route"></i>
                    <span class="menu-item-text">Itinerary</span>
                </a>
                <a href="../support/index.html" class="menu-item">
                    <i class="fas fa-headset"></i>
                    <span class="menu-item-text">Support</span>
                </a>
                <a href="../social/index.html" class="menu-item">
                    <i class="fas fa-share-alt"></i>
                    <span class="menu-item-text">Social</span>
                </a>
                <div class="menu-divider"></div>
                <a href="../reports/index.html" class="menu-item">
                    <i class="fas fa-chart-bar"></i>
                    <span class="menu-item-text">Reports</span>
                </a>
                <a href="../settings/index.html" class="menu-item">
                    <i class="fas fa-cog"></i>
                    <span class="menu-item-text">Settings</span>
                </a>
                <div class="menu-divider"></div>
                <a href="#" class="menu-item" id="logoutBtn">
                    <i class="fas fa-sign-out-alt"></i>
                    <span class="menu-item-text">Logout</span>
                </a>
            </div>
        </div>

        <!-- Main Content -->
        <div class="main-content" id="mainContent">
            <!-- Header -->
            <div class="main-header">
                <div class="d-flex align-items-center">
                    <button class="header-btn me-2" id="sidebarToggle">
                        <i class="fas fa-bars"></i>
                    </button>
                    <h4 class="page-title">Analytics Dashboard</h4>
                </div>
                <div class="header-controls">
                    <button class="header-btn">
                        <i class="fas fa-search"></i>
                    </button>
                    <button class="header-btn">
                        <i class="fas fa-bell"></i>
                        <span class="notification-badge"></span>
                    </button>
                    <div class="user-profile">
                        <div class="user-avatar">
                            <img src="https://via.placeholder.com/150" alt="User Avatar">
                        </div>
                        <div class="user-info">
                            <p class="user-name" id="userName">Loading...</p>
                            <p class="user-role" id="userRole">Loading...</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Content Container -->
            <div class="content-container">
                <div class="row mb-4">
                    <div class="col-12">
                        <div class="card">
                            <div class="card-header d-flex justify-content-between align-items-center">
                                <h5 class="card-title">Analytics Overview</h5>
                                <div>
                                    <select class="form-select form-select-sm d-inline-block w-auto me-2">
                                        <option>Last 7 Days</option>
                                        <option>Last 30 Days</option>
                                        <option>Last 90 Days</option>
                                        <option>This Year</option>
                                    </select>
                                    <button class="btn btn-sm btn-primary">
                                        <i class="fas fa-download me-1"></i> Export
                                    </button>
                                </div>
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-3">
                                        <div class="metric-card">
                                            <div class="metric-value">8,547</div>
                                            <div class="metric-label">Total Tourists</div>
                                            <div class="metric-change positive">
                                                <i class="fas fa-arrow-up"></i> 12.5%
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="metric-card">
                                            <div class="metric-value">$356,412</div>
                                            <div class="metric-label">Revenue</div>
                                            <div class="metric-change positive">
                                                <i class="fas fa-arrow-up"></i> 8.3%
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="metric-card">
                                            <div class="metric-value">64.2%</div>
                                            <div class="metric-label">Conversion Rate</div>
                                            <div class="metric-change negative">
                                                <i class="fas fa-arrow-down"></i> 2.1%
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="metric-card">
                                            <div class="metric-value">4.8/5</div>
                                            <div class="metric-label">Average Rating</div>
                                            <div class="metric-change positive">
                                                <i class="fas fa-arrow-up"></i> 0.3
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="mt-4">
                                    <canvas id="revenueChart" height="300"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="row mb-4">
                    <div class="col-md-6">
                        <div class="card h-100">
                            <div class="card-header">
                                <h5 class="card-title">Tourist Demographics</h5>
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-6">
                                        <h6 class="text-muted mb-3">Age Distribution</h6>
                                        <canvas id="ageChart" height="200"></canvas>
                                    </div>
                                    <div class="col-md-6">
                                        <h6 class="text-muted mb-3">Gender Distribution</h6>
                                        <canvas id="genderChart" height="200"></canvas>
                                    </div>
                                </div>
                                <hr>
                                <div class="row mt-3">
                                    <div class="col-12">
                                        <h6 class="text-muted mb-3">Top Countries of Origin</h6>
                                        <div class="country-list">
                                            <div class="country-item">
                                                <div class="country-name">United States</div>
                                                <div class="country-bar">
                                                    <div class="progress">
                                                        <div class="progress-bar bg-primary" role="progressbar" style="width: 28%" aria-valuenow="28" aria-valuemin="0" aria-valuemax="100"></div>
                                                    </div>
                                                </div>
                                                <div class="country-value">28%</div>
                                            </div>
                                            <div class="country-item">
                                                <div class="country-name">China</div>
                                                <div class="country-bar">
                                                    <div class="progress">
                                                        <div class="progress-bar bg-primary" role="progressbar" style="width: 22%" aria-valuenow="22" aria-valuemin="0" aria-valuemax="100"></div>
                                                    </div>
                                                </div>
                                                <div class="country-value">22%</div>
                                            </div>
                                            <div class="country-item">
                                                <div class="country-name">United Kingdom</div>
                                                <div class="country-bar">
                                                    <div class="progress">
                                                        <div class="progress-bar bg-primary" role="progressbar" style="width: 16%" aria-valuenow="16" aria-valuemin="0" aria-valuemax="100"></div>
                                                    </div>
                                                </div>
                                                <div class="country-value">16%</div>
                                            </div>
                                            <div class="country-item">
                                                <div class="country-name">Germany</div>
                                                <div class="country-bar">
                                                    <div class="progress">
                                                        <div class="progress-bar bg-primary" role="progressbar" style="width: 14%" aria-valuenow="14" aria-valuemin="0" aria-valuemax="100"></div>
                                                    </div>
                                                </div>
                                                <div class="country-value">14%</div>
                                            </div>
                                            <div class="country-item">
                                                <div class="country-name">Australia</div>
                                                <div class="country-bar">
                                                    <div class="progress">
                                                        <div class="progress-bar bg-primary" role="progressbar" style="width: 10%" aria-valuenow="10" aria-valuemin="0" aria-valuemax="100"></div>
                                                    </div>
                                                </div>
                                                <div class="country-value">10%</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="card h-100">
                            <div class="card-header">
                                <h5 class="card-title">Destination Trends</h5>
                            </div>
                            <div class="card-body">
                                <div class="mb-4">
                                    <canvas id="destinationChart" height="200"></canvas>
                                </div>
                                <h6 class="text-muted mb-3">Top Destinations by Season</h6>
                                <div class="table-responsive">
                                    <table class="table table-hover">
                                        <thead>
                                            <tr>
                                                <th>Destination</th>
                                                <th>Winter</th>
                                                <th>Spring</th>
                                                <th>Summer</th>
                                                <th>Fall</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td>Tokyo, Japan</td>
                                                <td><i class="fas fa-arrow-down text-danger"></i></td>
                                                <td><i class="fas fa-arrow-up text-success"></i></td>
                                                <td><i class="fas fa-minus text-muted"></i></td>
                                                <td><i class="fas fa-arrow-up text-success"></i></td>
                                            </tr>
                                            <tr>
                                                <td>Paris, France</td>
                                                <td><i class="fas fa-minus text-muted"></i></td>
                                                <td><i class="fas fa-arrow-up text-success"></i></td>
                                                <td><i class="fas fa-arrow-up text-success"></i></td>
                                                <td><i class="fas fa-arrow-down text-danger"></i></td>
                                            </tr>
                                            <tr>
                                                <td>New York, USA</td>
                                                <td><i class="fas fa-arrow-up text-success"></i></td>
                                                <td><i class="fas fa-minus text-muted"></i></td>
                                                <td><i class="fas fa-arrow-up text-success"></i></td>
                                                <td><i class="fas fa-arrow-up text-success"></i></td>
                                            </tr>
                                            <tr>
                                                <td>Bali, Indonesia</td>
                                                <td><i class="fas fa-arrow-down text-danger"></i></td>
                                                <td><i class="fas fa-minus text-muted"></i></td>
                                                <td><i class="fas fa-arrow-up text-success"></i></td>
                                                <td><i class="fas fa-arrow-down text-danger"></i></td>
                                            </tr>
                                            <tr>
                                                <td>Sydney, Australia</td>
                                                <td><i class="fas fa-arrow-up text-success"></i></td>
                                                <td><i class="fas fa-arrow-down text-danger"></i></td>
                                                <td><i class="fas fa-arrow-down text-danger"></i></td>
                                                <td><i class="fas fa-arrow-up text-success"></i></td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="row">
                    <div class="col-md-4">
                        <div class="card h-100">
                            <div class="card-header">
                                <h5 class="card-title">Booking Trends</h5>
                            </div>
                            <div class="card-body">
                                <canvas id="bookingTrendChart" height="250"></canvas>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="card h-100">
                            <div class="card-header">
                                <h5 class="card-title">Package Popularity</h5>
                            </div>
                            <div class="card-body">
                                <canvas id="packageChart" height="250"></canvas>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="card h-100">
                            <div class="card-header">
                                <h5 class="card-title">Revenue Forecast</h5>
                            </div>
                            <div class="card-body">
                                <canvas id="forecastChart" height="250"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Custom JS -->
    <script src="../../js/auth.js"></script>
    <script src="../../js/notifications.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize Analytics
            initializeAnalytics();
            
            // Sidebar toggle functionality
            document.getElementById('sidebarToggle').addEventListener('click', function() {
                document.getElementById('sidebar').classList.toggle('sidebar-collapsed');
                document.getElementById('mainContent').classList.toggle('content-collapsed');
            });

            // Logout functionality
            document.getElementById('logoutBtn').addEventListener('click', function(e) {
                e.preventDefault();
                localStorage.removeItem('tms_user');
                sessionStorage.removeItem('tms_user');
                window.location.href = '../../index.html';
            });

            // Load user info
            const userDataString = localStorage.getItem('tms_user') || sessionStorage.getItem('tms_user');
            if (userDataString) {
                const userData = JSON.parse(userDataString);
                document.getElementById('userName').textContent = userData.name;
                document.getElementById('userRole').textContent = userData.role;
            } else {
                window.location.href = '../../index.html';
            }
        });

        function initializeAnalytics() {
            // Revenue Chart
            const revenueCtx = document.getElementById('revenueChart').getContext('2d');
            new Chart(revenueCtx, {
                type: 'line',
                data: {
                    labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],
                    datasets: [{
                        label: 'Revenue',
                        data: [25000, 30000, 35000, 40000, 45000, 55000, 60000, 65000, 60000, 50000, 45000, 55000],
                        borderColor: '#4e73df',
                        backgroundColor: 'rgba(78, 115, 223, 0.05)',
                        borderWidth: 2,
                        pointBackgroundColor: '#4e73df',
                        pointBorderColor: '#fff',
                        pointBorderWidth: 2,
                        pointRadius: 4,
                        fill: true,
                        tension: 0.4
                    }, {
                        label: 'Target',
                        data: [30000, 30000, 30000, 40000, 40000, 40000, 50000, 50000, 50000, 60000, 60000, 60000],
                        borderColor: '#e74a3b',
                        borderWidth: 2,
                        borderDash: [5, 5],
                        pointRadius: 0,
                        fill: false
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'top',
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                callback: function(value) {
                                    return '$' + value.toLocaleString();
                                }
                            }
                        }
                    }
                }
            });

            // Age Distribution Chart
            const ageCtx = document.getElementById('ageChart').getContext('2d');
            new Chart(ageCtx, {
                type: 'pie',
                data: {
                    labels: ['18-24', '25-34', '35-44', '45-54', '55+'],
                    datasets: [{
                        data: [15, 35, 25, 15, 10],
                        backgroundColor: [
                            '#4e73df',
                            '#1cc88a',
                            '#36b9cc',
                            '#f6c23e',
                            '#e74a3b'
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });

            // Gender Distribution Chart
            const genderCtx = document.getElementById('genderChart').getContext('2d');
            new Chart(genderCtx, {
                type: 'doughnut',
                data: {
                    labels: ['Male', 'Female', 'Other'],
                    datasets: [{
                        data: [48, 51, 1],
                        backgroundColor: [
                            '#4e73df',
                            '#1cc88a',
                            '#36b9cc'
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });

            // Destination Chart
            const destinationCtx = document.getElementById('destinationChart').getContext('2d');
            new Chart(destinationCtx, {
                type: 'bar',
                data: {
                    labels: ['Tokyo', 'Paris', 'New York', 'Bali', 'Sydney', 'London', 'Rome', 'Cairo'],
                    datasets: [{
                        label: 'Previous Year',
                        data: [1200, 980, 850, 920, 750, 820, 680, 570],
                        backgroundColor: 'rgba(78, 115, 223, 0.5)',
                        borderWidth: 0
                    }, {
                        label: 'Current Year',
                        data: [1350, 1020, 920, 850, 890, 780, 750, 600],
                        backgroundColor: 'rgba(28, 200, 138, 0.5)',
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'top'
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Number of Tourists'
                            }
                        }
                    }
                }
            });

            // Booking Trend Chart
            const bookingTrendCtx = document.getElementById('bookingTrendChart').getContext('2d');
            new Chart(bookingTrendCtx, {
                type: 'line',
                data: {
                    labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],
                    datasets: [{
                        label: 'Bookings',
                        data: [250, 280, 320, 380, 450, 520, 580, 620, 580, 460, 390, 430],
                        borderColor: '#1cc88a',
                        backgroundColor: 'rgba(28, 200, 138, 0.1)',
                        borderWidth: 2,
                        fill: true,
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    }
                }
            });

            // Package Chart
            const packageCtx = document.getElementById('packageChart').getContext('2d');
            new Chart(packageCtx, {
                type: 'polarArea',
                data: {
                    labels: ['Adventure', 'Luxury', 'Budget', 'Family', 'Cultural'],
                    datasets: [{
                        data: [30, 20, 25, 15, 10],
                        backgroundColor: [
                            'rgba(78, 115, 223, 0.7)',
                            'rgba(28, 200, 138, 0.7)',
                            'rgba(246, 194, 62, 0.7)',
                            'rgba(54, 185, 204, 0.7)',
                            'rgba(231, 74, 59, 0.7)'
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });

            // Forecast Chart
            const forecastCtx = document.getElementById('forecastChart').getContext('2d');
            new Chart(forecastCtx, {
                type: 'bar',
                data: {
                    labels: ['Q1', 'Q2', 'Q3', 'Q4'],
                    datasets: [{
                        label: 'Actual Revenue',
                        data: [90000, 140000, 185000, null],
                        backgroundColor: 'rgba(78, 115, 223, 0.7)',
                        borderWidth: 0
                    }, {
                        label: 'Forecast',
                        data: [null, null, null, 160000],
                        backgroundColor: 'rgba(246, 194, 62, 0.7)',
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'top'
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                callback: function(value) {
                                    return '$' + value.toLocaleString();
                                }
                            }
                        }
                    }
                }
            });
        }
    </script>
</body>
</html> 